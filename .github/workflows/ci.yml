name: CI
on:
  push:
    branches: ['**']
    tags: [v*]
jobs:
  ci:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: olafurpg/setup-scala@v10
        with:
          java-version: 11
      - uses: actions/cache@v2
        with:
          path: |
            ~/.sbt
            ~/.ivy2/cache
            ~/.coursier
          key: ${{ runner.os }}-sbt-cache-v2-${{ hashFiles('**/*.sbt') }}-${{ hashFiles('project/build.properties') }}
      - uses: satackey/action-docker-layer-caching@v0.0.11
        continue-on-error: true
      - run: sbt bumpSnapshot
        env:
          DOCKER_REPOSITORY: docker.pkg.github.com
          DOCKER_USERNAME: ${{ github.repository_owner }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        shell: bash
#      # TODO some version bumping
#      - run: make graal-build-docker
#        shell: bash
#      - run: docker run --rm -i service
#        shell: bash
      # TODO pushing
      # TODO deploying


